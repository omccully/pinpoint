    <style>
       #map {
        height: 400px;
        width: 100%;
       }
    </style>
    <h3>Pinpoint</h3>
    <div id="map"></div>
    <script>
    markers = {}
    locations = {}
		// marker = 0;
		map = 0;
    function initMap() {
      /* var uluru = {lat: <%= @last_loc.latitude %>,
        lng: <%= @last_loc.longitude %>}; */
      map = new google.maps.Map(document.getElementById('map'), {
        zoom: 10
        // center: uluru
      });
      map.setMapTypeId(google.maps.MapTypeId.SATELLITE);
      /* 
      marker = new google.maps.Marker({
        position: uluru,
        map: map,
        label: '<%= @last_loc.device.name %>'
      }); */
    }
	  
	  function set_marker(marker, latitude, longitude) {
      marker.setPosition(new google.maps.LatLng(latitude, longitude));
    }

    window.setInterval(function() {
      $.get('/location/json', function(data, status) {
        locations = data;
        for(var id_code in locations) {
          if(locations.hasOwnProperty(id_code)) {
            coords = locations[id_code];
            if(markers.hasOwnProperty(id_code)) {
              set_marker(markers[id_code], coords.latitude,
                  coords.longitude);
            } else {
              markers[id_code] = new google.maps.Marker({
                position: { lat: coords.latitude, 
                            lng: coords.longitude },
                map: map,
                label: '<%= @last_loc.device.name %>'
              });
              alert(typeof(markers[id_code]) + "asdf" + coords.latitude + " " + 
                  coords.longitude);
            }
          }
        }
        set_marker(data.latitude, data.longitude);
        map.panTo(new google.maps.LatLng(data.latitude, data.longitude));
      }, "json");
    }, 2000);

    </script>
    <script async defer
    src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAqO2ai1uwdMDcxrg4Foc3_OfQKghsIqk4&callback=initMap">
    </script>

